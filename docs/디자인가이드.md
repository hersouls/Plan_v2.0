*최종 업데이트: 2025년 8월*

---

## 1. 개요 및 원칙

- **목적**: 본 문서는 Moonwave Plan Family Task Management의 디자인 시스템 v2.0을 표준화하여, 여러 저장소(Repositories)에서 100% 동일하게 참조할 수 있도록 정리한 단일 소스 가이드입니다.
- **적용 범위**: 프론트엔드 UI/UX 전반(디자인 토큰, 컴포넌트 스타일, 반응형/접근성)과 배포/보안 관련 구현 가이드까지 포함합니다.
- **운영 플래그**: `--all`, `--seq`, `--ultrathink`, `Step by step` 모드로 전체 요소를 순차적으로, 누락 없이 정리합니다.

---

## 2. 버전 및 호환성

- **문서 버전**: v2.0
- **토큰 기준**: 디자인 토큰은 v2.x 기준(현행 코드 기준 v2.1 값 포함)에 맞춰 정의되었습니다. 하위 호환을 유지합니다.
- **레포지토리 독립성**: 파일 경로와 배포 설정은 일반화하여 저장소 간 동일 문서를 유지합니다. 필요 시 각 프로젝트 경로에 매핑하세요.

---

## 3. 디자인 토큰 시스템 개요

- **Foundation Tokens(기초)**: 색상, 간격, 타이포그래피, 경계 반경, 그림자 등 UI의 기본 값
- **Semantic Tokens(의미)**: 역할 중심(primary/success/warning/danger, text/background/border 등)
- **Component Tokens(컴포넌트)**: Button, Card, Input 등 즉시 사용 가능한 컴포넌트 수준 값
- **도메인 토큰**: 카테고리/상태/우선순위 색상, 터치 타깃 등 서비스 특화 토큰
- **Interaction/Effect Tokens**: 애니메이션 시간 및 이징, 글래스/웨이브/그라데이션 패턴 등

---

## 4. Foundation Tokens(기초 토큰)

### 4.1 Colors

- **Blue**: 50 `#eff6ff`, 100 `#dbeafe`, 200 `#bfdbfe`, 300 `#93c5fd`, 400 `#60a5fa`, 500 `#3b82f6`, 600 `#2563eb`, 700 `#1d4ed8`, 800 `#1e40af`, 900 `#1e3a8a`
- **Gray**: 50 `#f9fafb`, 100 `#f3f4f6`, 200 `#e5e7eb`, 300 `#d1d5db`, 400 `#9ca3af`, 500 `#6b7280`, 600 `#4b5563`, 700 `#374151`, 800 `#1f2937`, 900 `#111827`
- **Green**: 50 `#f0fdf4`, 500 `#22c55e`, 600 `#16a34a`
- **Yellow**: 50 `#fefce8`, 500 `#eab308`, 600 `#ca8a04`
- **Red**: 50 `#fef2f2`, 500 `#ef4444`, 600 `#dc2626`
- **추가 팔레트(도메인)**: Amber 500 `#f59e0b`, Violet 500 `#8b5cf6`, Pink 500 `#ec4899`, Emerald 500 `#10b981`

### 4.2 Spacing(8px Grid)

- 0, 4px, 8px, 12px, 16px, 20px, 24px, 32px, 40px, 48px, 64px, 80px, 96px

### 4.3 Typography

- **Font family**: `Pretendard Variable` 우선, 시스템 폰트 폴백
- **Sizes**: xs 12px, sm 14px, base 16px, lg 18px, xl 20px, 2xl 24px, 3xl 30px, 4xl 36px
- **Letter spacing(권장)**: base 이상 `-0.01em`, 3xl/4xl `-0.02em`

### 4.4 Border Radius

- none 0, sm 2px, md 6px, lg 8px, xl 12px, 2xl 16px

### 4.5 Shadow

- sm `0 1px 2px 0 rgb(0 0 0 / 0.05)`
- md `0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)`
- lg `0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)`
- xl `0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1)`

---

## 5. Semantic Tokens(의미 토큰)

### 5.1 Colors(역할)

- **primary**: 50→`var(--foundation-blue-50)`, 500→`--foundation-blue-500`, 600→`--foundation-blue-600`, 700→`--foundation-blue-700`
- **success**: 50→`--foundation-green-50`, 500→`--foundation-green-500`, 600→`--foundation-green-600`
- **warning**: 50→`--foundation-yellow-50`, 500→`--foundation-yellow-500`, 600→`--foundation-yellow-600`
- **danger**: 50→`--foundation-red-50`, 500→`--foundation-red-500`, 600→`--foundation-red-600`
- **text**: primary `#111827`(semantic 적용 시 다크에서 `#ffffff` 권장), secondary `#374151`(다크 `#f1f5f9`), tertiary `#6b7280`(다크 `#e2e8f0`), inverse `#ffffff`
- **background**: primary `#ffffff`(다크 `#0f172a`), secondary `--foundation-gray-50`(다크 `#1e293b`), tertiary `--foundation-gray-100`(다크 `#334155`)
- **border**: primary `--foundation-gray-200`(다크 `#475569`), secondary `--foundation-gray-300`(다크 `#64748b`), focus `--foundation-blue-500`

### 5.2 Spacing alias

- xs `--foundation-spacing-2`, sm `--foundation-spacing-4`, md `--foundation-spacing-6`, lg `--foundation-spacing-8`, xl `--foundation-spacing-12`

### 5.3 Typography alias

- title: 4xl/700/1.2/`-0.02em`
- heading: 2xl/600/1.3/`-0.01em`
- body: base/400/1.6/`-0.01em`
- caption: sm/400/1.4/`0em`

---

## 6. Component Tokens(컴포넌트 토큰)

### 6.1 Button

- **Primary**: bg `--semantic-primary-600`, color `--semantic-text-inverse`, radius `--foundation-borderRadius-lg`, px `--semantic-spacing-sm`, py `--semantic-spacing-xs`, fontSize `--foundation-fontSize-base`, fontWeight 600, hover bg `--semantic-primary-700`
- **Secondary**: bg `--semantic-background-primary`, color `--semantic-text-primary`, border `1px solid --semantic-border-primary`, radius `--foundation-borderRadius-lg`, px `--semantic-spacing-sm`, py `--semantic-spacing-xs`

### 6.2 Card

- bg `--semantic-background-primary`, border `1px solid --semantic-border-primary`, radius `--foundation-borderRadius-xl`, padding `--semantic-spacing-md`, shadow `--foundation-shadow-sm`(hover md)

### 6.3 Input

- bg `--semantic-background-primary`, border `1px solid --semantic-border-primary`, radius `--foundation-borderRadius-md`, px/py `--semantic-spacing-xs`, fontSize `--foundation-fontSize-base`, focus border `--semantic-border-focus`(ring `0 0 0 2px rgba(59,130,246,.2)`)

### 6.4 Task Card(도메인)

- bg `--semantic-background-primary`, border `1px solid --semantic-border-primary`, radius `--foundation-borderRadius-xl`, padding `--semantic-spacing-md`, shadow `--foundation-shadow-md`, hoverShadow `--foundation-shadow-lg`

### 6.5 Family Avatar(도메인)

- size 40px, borderWidth 2px, borderColor `--semantic-primary-600`, bg `--semantic-primary-50`, color `--semantic-primary-600`

---

## 7. 도메인 토큰(카테고리/상태/우선순위, 터치)

- **카테고리**: home `--foundation-amber-500`, work `--foundation-violet-500`, personal `--foundation-pink-500`, shopping `--foundation-emerald-500`, etc `--foundation-gray-500`
- **상태**: pending `--foundation-amber-500`, progress `--foundation-blue-500`, completed `--foundation-green-500`, overdue `--foundation-red-500`
- **우선순위**: high `--foundation-red-500`, medium `--foundation-amber-500`, low `--foundation-gray-500`
- **터치 타깃**: min 44px(`--touch-target-min`), comfortable 48px, large 56px

---

## 8. Interaction/Effect Tokens

- **Duration**: fast 150ms, normal 300ms, slow 500ms
- **Easing**: `cubic-bezier(0.25, 0.46, 0.45, 0.94)`, `cubic-bezier(0.4, 0, 0.2, 1)`, `cubic-bezier(0.68, -0.55, 0.265, 1.55)`
- **Glass**: light/medium/strong/border RGBA 정의(투명 유리 효과)
- **Gradient Presets**: moonwave, sunset, ocean, forest, purple, brand(+ 방향: vertical/horizontal/diagonal/radial)
- **Wave Patterns**: gentle/dynamic/dramatic(SVG path), 색상/높이/투명도 프리셋

---

## 9. 전역 CSS 변수 정의(:root) — 완전본

아래 블록은 전역 CSS 변수의 표준 정의입니다. 저장소 간 동일성 유지를 위해 그대로 사용하세요.

```css
:root {
  /* =============================================================================
   * DESIGN TOKENS - Moonwave Plan Family Task Management
   * Based on Design Guide v2.1 - Single Source of Truth
   * ============================================================================= */

  /* Font family configuration */
  --font-pretendard: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui,
    Roboto, 'Helvetica Neue', 'Segoe UI', 'Apple SD Gothic Neo', 'Noto Sans KR',
    'Malgun Gothic', sans-serif;
  --font-size: 16px; /* Improved base size for family readability */

  /* =============================================================================
   * FOUNDATION TOKENS - Base Design Values
   * ============================================================================= */

  /* Foundation Colors */
  --foundation-blue-50: #eff6ff;
  --foundation-blue-100: #dbeafe;
  --foundation-blue-200: #bfdbfe;
  --foundation-blue-300: #93c5fd;
  --foundation-blue-400: #60a5fa;
  --foundation-blue-500: #3b82f6;
  --foundation-blue-600: #2563eb;
  --foundation-blue-700: #1d4ed8;
  --foundation-blue-800: #1e40af;
  --foundation-blue-900: #1e3a8a;

  --foundation-gray-50: #f9fafb;
  --foundation-gray-100: #f3f4f6;
  --foundation-gray-200: #e5e7eb;
  --foundation-gray-300: #d1d5db;
  --foundation-gray-400: #9ca3af;
  --foundation-gray-500: #6b7280;
  --foundation-gray-600: #4b5563;
  --foundation-gray-700: #374151;
  --foundation-gray-800: #1f2937;
  --foundation-gray-900: #111827;

  --foundation-green-50: #f0fdf4;
  --foundation-green-500: #22c55e;
  --foundation-green-600: #16a34a;

  --foundation-yellow-50: #fefce8;
  --foundation-yellow-500: #eab308;
  --foundation-yellow-600: #ca8a04;

  --foundation-red-50: #fef2f2;
  --foundation-red-500: #ef4444;
  --foundation-red-600: #dc2626;

  --foundation-amber-500: #f59e0b;
  --foundation-violet-500: #8b5cf6;
  --foundation-pink-500: #ec4899;
  --foundation-emerald-500: #10b981;

  /* Foundation Spacing (8px grid) */
  --foundation-spacing-0: 0;
  --foundation-spacing-1: 0.25rem; /* 4px */
  --foundation-spacing-2: 0.5rem; /* 8px */
  --foundation-spacing-3: 0.75rem; /* 12px */
  --foundation-spacing-4: 1rem; /* 16px */
  --foundation-spacing-5: 1.25rem; /* 20px */
  --foundation-spacing-6: 1.5rem; /* 24px */
  --foundation-spacing-8: 2rem; /* 32px */
  --foundation-spacing-10: 2.5rem; /* 40px */
  --foundation-spacing-12: 3rem; /* 48px */
  --foundation-spacing-16: 4rem; /* 64px */
  --foundation-spacing-20: 5rem; /* 80px */
  --foundation-spacing-24: 6rem; /* 96px */

  /* Foundation Typography */
  --foundation-fontSize-xs: 0.75rem; /* 12px */
  --foundation-fontSize-sm: 0.875rem; /* 14px */
  --foundation-fontSize-base: 1rem; /* 16px */
  --foundation-fontSize-lg: 1.125rem; /* 18px */
  --foundation-fontSize-xl: 1.25rem; /* 20px */
  --foundation-fontSize-2xl: 1.5rem; /* 24px */
  --foundation-fontSize-3xl: 1.875rem; /* 30px */
  --foundation-fontSize-4xl: 2.25rem; /* 36px */

  /* Foundation Border Radius */
  --foundation-borderRadius-none: 0;
  --foundation-borderRadius-sm: 0.125rem; /* 2px */
  --foundation-borderRadius-md: 0.375rem; /* 6px */
  --foundation-borderRadius-lg: 0.5rem; /* 8px */
  --foundation-borderRadius-xl: 0.75rem; /* 12px */
  --foundation-borderRadius-2xl: 1rem; /* 16px */

  /* Foundation Shadow */
  --foundation-shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --foundation-shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1),
    0 2px 4px -2px rgb(0 0 0 / 0.1);
  --foundation-shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1),
    0 4px 6px -4px rgb(0 0 0 / 0.1);
  --foundation-shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1),
    0 8px 10px -6px rgb(0 0 0 / 0.1);

  /* =============================================================================
   * SEMANTIC TOKENS - Meaningful Design Intent
   * ============================================================================= */

  /* Semantic Colors - Primary Brand */
  --semantic-primary-50: var(--foundation-blue-50);
  --semantic-primary-500: var(--foundation-blue-500);
  --semantic-primary-600: var(--foundation-blue-600);
  --semantic-primary-700: var(--foundation-blue-700);

  /* Semantic Colors - Status States */
  --semantic-success-50: var(--foundation-green-50);
  --semantic-success-500: var(--foundation-green-500);
  --semantic-success-600: var(--foundation-green-600);

  --semantic-warning-50: var(--foundation-yellow-50);
  --semantic-warning-500: var(--foundation-yellow-500);
  --semantic-warning-600: var(--foundation-yellow-600);

  --semantic-danger-50: var(--foundation-red-50);
  --semantic-danger-500: var(--foundation-red-500);
  --semantic-danger-600: var(--foundation-red-600);

  /* Semantic Colors - Text (다크모드로 통일) */
  --semantic-text-primary: #ffffff; /* Pure white for maximum contrast */
  --semantic-text-secondary: #f1f5f9; /* 더 밝은 회색으로 가독성 향상 */
  --semantic-text-tertiary: #e2e8f0; /* 더 밝은 회색으로 적절한 대비 */
  --semantic-text-inverse: #ffffff;

  /* Semantic Colors - Background (다크모드로 통일) */
  --semantic-background-primary: #0f172a;
  --semantic-background-secondary: #1e293b;
  --semantic-background-tertiary: #334155;

  /* Semantic Colors - Border (다크모드로 통일) */
  --semantic-border-primary: #475569;
  --semantic-border-secondary: #64748b;
  --semantic-border-focus: var(--foundation-blue-500);

  /* Semantic Spacing */
  --semantic-spacing-xs: var(--foundation-spacing-2); /* 8px */
  --semantic-spacing-sm: var(--foundation-spacing-4); /* 16px */
  --semantic-spacing-md: var(--foundation-spacing-6); /* 24px */
  --semantic-spacing-lg: var(--foundation-spacing-8); /* 32px */
  --semantic-spacing-xl: var(--foundation-spacing-12); /* 48px */

  /* =============================================================================
   * FAMILY TASK MANAGEMENT TOKENS
   * ============================================================================= */

  /* Task Category Colors */
  --category-home: var(--foundation-amber-500); /* 집안일 */
  --category-work: var(--foundation-violet-500); /* 업무 */
  --category-personal: var(--foundation-pink-500); /* 개인 */
  --category-shopping: var(--foundation-emerald-500); /* 쇼핑 */
  --category-etc: var(--foundation-gray-500); /* 기타 */

  /* Task Status Colors */
  --status-pending: var(--foundation-amber-500); /* 대기 */
  --status-progress: var(--foundation-blue-500); /* 진행중 */
  --status-completed: var(--foundation-green-500); /* 완료 */
  --status-overdue: var(--foundation-red-500); /* 지연 */

  /* Task Priority Colors */
  --priority-high: var(--foundation-red-500); /* 긴급 */
  --priority-medium: var(--foundation-amber-500); /* 중요 */
  --priority-low: var(--foundation-gray-500); /* 일반 */

  /* Touch Target Sizing (44px minimum) */
  --touch-target-min: 2.75rem; /* 44px */
  --touch-target-comfortable: 3rem; /* 48px */
  --touch-target-large: 3.5rem; /* 56px */

  /* =============================================================================
   * COMPONENT TOKENS - Ready-to-use Component Values
   * ============================================================================= */

  /* Component: Button Primary */
  --component-button-primary-backgroundColor: var(--semantic-primary-600);
  --component-button-primary-color: var(--semantic-text-inverse);
  --component-button-primary-borderRadius: var(--foundation-borderRadius-lg);
  --component-button-primary-paddingX: var(--semantic-spacing-sm);
  --component-button-primary-paddingY: var(--semantic-spacing-xs);
  --component-button-primary-fontSize: var(--foundation-fontSize-base);
  --component-button-primary-fontWeight: 600;
  --component-button-primary-minHeight: var(--touch-target-min);

  /* Component: Button Secondary */
  --component-button-secondary-backgroundColor: var(
    --semantic-background-primary
  );
  --component-button-secondary-color: var(--semantic-text-primary);
  --component-button-secondary-border: 1px solid var(--semantic-border-primary);
  --component-button-secondary-borderRadius: var(--foundation-borderRadius-lg);
  --component-button-secondary-paddingX: var(--semantic-spacing-sm);
  --component-button-secondary-paddingY: var(--semantic-spacing-xs);

  /* Component: Input */
  --component-input-backgroundColor: var(--semantic-background-primary);
  --component-input-color: var(--semantic-text-primary);
  --component-input-border: 1px solid var(--semantic-border-primary);
  --component-input-borderRadius: var(--foundation-borderRadius-lg);
  --component-input-paddingX: var(--semantic-spacing-sm);
  --component-input-paddingY: var(--semantic-spacing-xs);
  --component-input-fontSize: var(--foundation-fontSize-base);
  --component-input-minHeight: var(--touch-target-min);

  /* Component: Card */
  --component-card-backgroundColor: var(--semantic-background-primary);
  --component-card-border: 1px solid var(--semantic-border-primary);
  --component-card-borderRadius: var(--foundation-borderRadius-xl);
  --component-card-padding: var(--semantic-spacing-md);
  --component-card-shadow: var(--foundation-shadow-md);

  /* Component: Task Card */
  --component-taskCard-backgroundColor: var(--semantic-background-primary);
  --component-taskCard-border: 1px solid var(--semantic-border-primary);
  --component-taskCard-borderRadius: var(--foundation-borderRadius-xl);
  --component-taskCard-padding: var(--semantic-spacing-md);
  --component-taskCard-shadow: var(--foundation-shadow-md);
  --component-taskCard-hoverShadow: var(--foundation-shadow-lg);

  /* Component: Family Avatar */
  --component-familyAvatar-size: 2.5rem; /* 40px */
  --component-familyAvatar-borderWidth: 2px;
  --component-familyAvatar-borderColor: var(--semantic-primary-600);
  --component-familyAvatar-backgroundColor: var(--semantic-primary-50);
  --component-familyAvatar-color: var(--semantic-primary-600);

  /* =============================================================================
   * ANIMATION & INTERACTION TOKENS
   * ============================================================================= */

  /* Animation Duration */
  --duration-fast: 150ms; /* Quick interactions */
  --duration-normal: 300ms; /* Standard transitions */
  --duration-slow: 500ms; /* Complex animations */

  /* Animation Easing */
  --ease-out: cubic-bezier(0.25, 0.46, 0.45, 0.94);
  --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
  --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);

  /* Glass Morphism Effects */
  --glass-light: rgba(255, 255, 255, 0.05);
  --glass-medium: rgba(255, 255, 255, 0.1);
  --glass-strong: rgba(255, 255, 255, 0.15);
  --glass-border: rgba(255, 255, 255, 0.2);

  /* =============================================================================
   * LAYOUT & STRUCTURE TOKENS
   * ============================================================================= */

  /* Background System (다크모드로 통일) */
  --background: var(--semantic-background-primary);
  --foreground: var(--semantic-text-primary);
  --background-secondary: var(--semantic-background-secondary);
  --background-tertiary: var(--semantic-background-tertiary);

  /* Card System */
  --card: var(--component-card-backgroundColor);
  --card-foreground: var(--semantic-text-primary);
  --card-border: var(--semantic-border-primary);
  --card-shadow: var(--component-card-shadow);
  --card-hover: var(--semantic-background-secondary);
  --card-radius: var(--component-card-borderRadius);
  --card-padding: var(--component-card-padding);

  /* UI Element System (다크모드로 통일) */
  --muted: var(--semantic-background-tertiary);
  --muted-foreground: var(--semantic-text-tertiary);

  --border: var(--semantic-border-primary);
  --border-strong: var(--semantic-border-secondary);
  --border-focus: var(--semantic-border-focus);

  --input: rgba(255, 255, 255, 0.15);
  --input-background: var(--semantic-background-secondary);
  --input-border: var(--semantic-border-primary);
  --input-focus: var(--semantic-border-focus);
  --input-padding-x: var(--component-input-paddingX);
  --input-padding-y: var(--component-input-paddingY);
  --input-radius: var(--component-input-borderRadius);
  --input-min-height: var(--component-input-minHeight);

  --popover: var(--semantic-background-secondary);
  --popover-foreground: var(--semantic-text-primary);
  --popover-border: var(--semantic-border-primary);

  --accent: var(--semantic-background-tertiary);
  --accent-foreground: var(--semantic-text-primary);

  /* Legacy Support */
  --primary: var(--semantic-primary-600);
  --primary-foreground: var(--semantic-text-inverse);
  --primary-hover: var(--semantic-primary-700);
  --primary-active: var(--semantic-primary-700);
  --primary-light: var(--semantic-primary-50);
  --primary-gradient: linear-gradient(
    135deg,
    var(--semantic-primary-600),
    var(--semantic-primary-700)
  );
  --primary-glow: 0 0 20px rgba(59, 130, 246, 0.4);

  --secondary: #a855f7;
  --secondary-foreground: #ffffff;
  --secondary-hover: #9333ea;
  --secondary-active: #7e22ce;
  --secondary-light: #e9d5ff;
  --secondary-gradient: linear-gradient(135deg, #a855f7, #7e22ce);
  --secondary-glow: 0 0 20px rgba(168, 85, 247, 0.4);

  --success: var(--semantic-success-500);
  --success-foreground: var(--semantic-text-inverse);
  --success-light: var(--semantic-success-50);

  --warning: var(--semantic-warning-500);
  --warning-foreground: var(--semantic-text-inverse);
  --warning-light: var(--semantic-warning-50);

  --error: var(--semantic-danger-500);
  --error-foreground: var(--semantic-text-inverse);
  --error-light: var(--semantic-danger-50);

  --info: var(--semantic-primary-500);
  --info-foreground: var(--semantic-text-inverse);
  --info-light: var(--semantic-primary-50);

  --destructive: var(--semantic-danger-500);
  --destructive-foreground: var(--semantic-text-inverse);
  --ring: rgba(203, 213, 225, 0.4);
  --radius: var(--foundation-borderRadius-lg);
  --font-weight-medium: 500;
  --font-weight-normal: 400;
}
```

---

## 10. Tailwind 설정 매핑

아래는 토큰과 Tailwind 테마 간의 대표 매핑 요약입니다(필요 시 전체 설정 그대로 사용 권장).

- **fontFamily**: `pretendard`, `sans` → Pretendard Variable 계열
- **fontSize**: xs~4xl + 한국어 최적화 변형(xs-ko~4xl-ko)
- **letterSpacing**: `ko-tight`, `ko-normal`, `ko-wide`
- **colors**:
  - `foundation.*` 팔레트(blue/gray/green/yellow/red)
  - `semantic.*` 역할별 색상(50/500/600/700)
  - `primary.*`, `plan.*`(상태), `category.*`(도메인), `glass.*`
  - 배경/테두리/포그라운드 토큰(`background`, `border`, `ring` 등)
- **spacing**: xs/sm/md/lg/xl + 터치 타깃 spacing
- **borderRadius/boxShadow/transitionDuration**: 토큰 값과 동기화
- **screens**: xs 320, sm 360, md 375, lg 768, xl 1024, 2xl 1440, 3xl 1920
- **container**: center + breakpoint별 padding
- **plugins**: `@tailwindcss/container-queries`

Tailwind 원본 설정 예시는 저장소의 `tailwind.config.js`를 그대로 사용하세요.

---

## 11. 사용 가이드(Step by step)

1) **토큰 우선**: Foundation → Semantic → Component 순서로 적용합니다.
2) **CSS 변수 사용**: 스타일은 `var(--token)` 형태로 연결하여 일관성/테마 전환을 보장합니다.
3) **Tailwind 매핑**: 자주 쓰는 값은 Tailwind 토큰으로 접근(`text-background`, `bg-card`, `shadow-glass` 등).
4) **접근성**: 대비(문자/배경 4.5:1 이상), 터치 타깃 44px 이상, 모션 선호 설정 존중.
5) **반응형**: `xs`→`3xl` 브레이크포인트를 기준으로 점진적 증강.
6) **컴포넌트**: Button/Card/Input은 컴포넌트 토큰으로만 스타일 지정(직접 색상/수치 하드코딩 금지).

간단 예시

```css
.primary-button {
  background: var(--component-button-primary-backgroundColor);
  color: var(--component-button-primary-color);
  border-radius: var(--component-button-primary-borderRadius);
  padding: var(--component-button-primary-paddingY)
           var(--component-button-primary-paddingX);
}
```

```tsx
// React + Tailwind 예시
<button className="bg-primary-600 text-primary-foreground rounded-lg px-sm py-xs hover:bg-primary-hover">
  저장
</button>
```

---

## 12. 백엔드 아키텍처 가이드 (Firebase Functions)

### 12.1 개요
- 백엔드 런타임: Firebase Cloud Functions (Node.js 20)
- 관리 대상: 할일(Task) 관련 이벤트 처리, 알림(Notification), 그룹/사용자 통계 집계, 주기적 리마인더 및 요약 전송
- 소스 위치: `functions/src/index.ts`

### 12.2 이벤트 트리거 요약
- onTaskCreated: `tasks/{taskId}` 문서 생성 시 작업 할당 알림, 그룹 통계 갱신, 활동 로그 생성
- onTaskUpdated: `tasks/{taskId}` 문서 업데이트 시 완료 처리, 재할당 알림, 그룹 통계 갱신
- onCommentCreated: `comments` 문서 생성 시 과제 참여자에게 댓글 알림, 댓글 수 갱신
- onCommentDeleted: `comments` 문서 삭제 시 과제의 댓글 수 갱신
- sendDailyReminders (스케줄): 매일 09:00, 마감 임박/지남 할일 알림 발송
- sendWeeklySummary (스케줄): 매주 일요일 18:00, 그룹 구성원별 주간 요약 발송

### 12.3 데이터 경로 및 규칙 의존성
- 주요 컬렉션: `tasks`, `comments`, `users`, `groups`, `activities`
- Functions는 Firestore/Storage 보안 규칙과 호환되도록 설계되었으며, 클라이언트 권한이 아닌 관리자(Admin SDK) 권한으로 실행됩니다.

### 12.4 알림(FCM) 정책
- 사용자 문서(`users/{userId}`)의 `fcmTokens: string[]`를 통해 멀티캐스트 발송
- 알림 data 페이로드에 `type`, `taskId`, `url` 등을 포함하여 클라이언트 라우팅과 UX 연계

### 12.5 스케줄 작업(CRON)
- 일일 리마인더: `0 9 * * *`
- 주간 요약: `0 18 * * 0`

### 12.6 배포
- Functions 단독 배포: `npm run firebase:deploy:functions`
- 전체(파이어스토어 룰/인덱스/스토리지 포함): `npm run firebase:deploy`

---

## 13. Firebase Firestore 설계 및 보안 규칙

### 13.1 주요 컬렉션 및 문서 모델
- users/{userId}: 사용자 프로필, 개인정보 공개 설정(privacy), fcmTokens, stats
- users/{userId}/settings: 사용자 설정 서브컬렉션
- groups/{groupId}: 그룹 소유자, 멤버 정책, 통계 필드(totalTasks, completionRate 등)
- groups/{groupId}/members/{memberId}: 그룹 멤버십 관리
- groups/{groupId}/chat/{messageId}: 그룹 채팅 메시지
- tasks/{taskId}: 개인/그룹 할일, 담당자, 상태, 마감일 등
- comments: 태스크 댓글(태스크 단위로 쿼리)
- notifications/{notificationId}: 사용자별 알림 저장
- activities/{activityId}: 활동 로그(읽기 전용)
- statistics/{userId}: 개인 통계(공개 옵션 지원)
- invites/{inviteId}: 그룹 초대 관리
- pointHistory / pointRules / pointStats: 포인트 시스템 관련 컬렉션

### 13.2 Firestore 보안 규칙 (실제 적용본)

``` 
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Helper functions
    function isAuthenticated() {
      return request.auth != null;
    }
    
    function isOwner(userId) {
      return isAuthenticated() && request.auth.uid == userId;
    }
    
    // Simplified group functions - reduced database lookups
    function isGroupMember(groupId) {
      return isAuthenticated() && 
        exists(/databases/$(database)/documents/groups/$(groupId)/members/$(request.auth.uid));
    }
    
    function isGroupOwner(groupId) {
      return isAuthenticated() && 
        exists(/databases/$(database)/documents/groups/$(groupId)) &&
        request.auth.uid == resource.data.ownerId;
    }
    
    // Simplified rules for better performance - removed catch-all rule
    
    // 사용자 프로필 컬렉션 보안 규칙
    match /users/{userId} {
      allow read: if isOwner(userId) || 
        (isAuthenticated() && resource.data.privacy.showTaskActivity == true);
      allow write: if isOwner(userId);
      allow create: if isAuthenticated() && request.auth.uid == userId;
    }
    
    // 사용자 설정 서브컬렉션
    match /users/{userId}/settings/{document=**} {
      allow read, write: if isOwner(userId);
    }
    
    // 그룹 컬렉션 보안 규칙
    match /groups/{groupId} {
      allow read: if isAuthenticated();
      allow create: if isAuthenticated() && 
        request.auth.uid == request.resource.data.ownerId;
      allow update: if isAuthenticated() && 
        (isGroupOwner(groupId) || 
         (isGroupMember(groupId) && 
          resource.data.settings.allowMembersToInvite == true));
      allow delete: if isAuthenticated() && isGroupOwner(groupId);
      
      // 그룹 멤버 서브컬렉션
      match /members/{memberId} {
        allow read: if isGroupMember(groupId);
        allow write: if isGroupOwner(groupId);
      }
      
      // 그룹 채팅 서브컬렉션
      match /chat/{messageId} {
        allow read: if isGroupMember(groupId);
        allow create: if isGroupMember(groupId) && 
          request.auth.uid == request.resource.data.userId;
        allow update, delete: if isGroupMember(groupId) && 
          request.auth.uid == resource.data.userId;
      }
    }
    
    // 할일(Task) 컬렉션 보안 규칙
    match /tasks/{taskId} {
      allow read: if isAuthenticated() && 
        (request.auth.uid == resource.data.userId ||
         request.auth.uid == resource.data.assigneeId ||
         (resource.data.taskType == 'group' && resource.data.groupId != null && isGroupMember(resource.data.groupId)));
      
      allow create: if isAuthenticated() && 
        request.auth.uid == request.resource.data.userId &&
        ((request.resource.data.taskType == 'personal') ||
         (request.resource.data.taskType == 'group' && request.resource.data.groupId != null && isGroupMember(request.resource.data.groupId)));
      
      allow update: if isAuthenticated() && 
        (request.auth.uid == resource.data.userId ||
         request.auth.uid == resource.data.assigneeId ||
         (resource.data.taskType == 'group' && resource.data.groupId != null && isGroupMember(resource.data.groupId) && 
          resource.data.groupId == request.resource.data.groupId));
      
      allow delete: if isAuthenticated() && 
        (request.auth.uid == resource.data.userId ||
         (resource.data.taskType == 'group' && resource.data.groupId != null && isGroupOwner(resource.data.groupId)));
      
      // Simplified comments - inherit task permissions
      match /comments/{commentId} {
        allow read: if isAuthenticated();
        allow create: if isAuthenticated() && 
          request.auth.uid == request.resource.data.userId;
        allow update, delete: if isAuthenticated() && 
          request.auth.uid == resource.data.userId;
      }
    }
    
    // 알림 컬렉션 보안 규칙
    match /notifications/{notificationId} {
      allow read: if isOwner(resource.data.userId);
      allow create: if isAuthenticated();
      allow update: if isOwner(resource.data.userId) && 
        request.resource.data.read != resource.data.read; // Only allow marking as read
      allow delete: if isOwner(resource.data.userId);
    }
    
    // 활동 로그 컬렉션 보안 규칙 (읽기 전용)
    match /activities/{activityId} {
      allow read: if isAuthenticated() && 
        (request.auth.uid == resource.data.userId ||
         isGroupMember(resource.data.groupId));
      allow create: if isAuthenticated() && 
        request.auth.uid == request.resource.data.userId;
      allow update, delete: if false; // 수정/삭제 불가
    }
    
    // 통계 컬렉션 보안 규칙
    match /statistics/{userId} {
      allow read: if isOwner(userId) || 
        (isAuthenticated() && resource.data.public == true);
      allow write: if isOwner(userId);
    }
    
    // 그룹 초대 컬렉션
    match /invites/{inviteId} {
      allow read: if isAuthenticated() && 
        (request.auth.uid == resource.data.invitedBy ||
         request.auth.email == resource.data.invitedEmail);
      allow create: if isAuthenticated() && 
        isGroupMember(request.resource.data.groupId);
      allow update: if isAuthenticated() && 
        request.auth.email == resource.data.invitedEmail &&
        request.resource.data.status != resource.data.status; // Only status change
      allow delete: if isGroupOwner(resource.data.groupId);
    }
    
    // 포인트 내역 컬렉션 보안 규칙
    match /pointHistory/{historyId} {
      allow read: if isAuthenticated() && 
        (resource.data.userId == request.auth.uid || 
         isGroupMember(resource.data.groupId));
      allow create: if isAuthenticated() && 
        (request.resource.data.userId == request.auth.uid || 
         isGroupOwner(request.resource.data.groupId));
      allow update, delete: if isAuthenticated() && 
        isGroupOwner(resource.data.groupId);
    }
    
    // 포인트 규칙 컬렉션 보안 규칙
    match /pointRules/{ruleId} {
      allow read: if isAuthenticated() && 
        isGroupMember(resource.data.groupId);
      allow create, update, delete: if isAuthenticated() && 
        isGroupOwner(resource.data.groupId);
    }
    
    // 포인트 통계 컬렉션 보안 규칙
    match /pointStats/{statsId} {
      allow read: if isAuthenticated() && 
        (resource.data.userId == request.auth.uid || 
         isGroupMember(resource.data.groupId));
      allow create, update: if isAuthenticated() && 
        (resource.data.userId == request.auth.uid || 
         isGroupOwner(resource.data.groupId));
    }
    
    // 기본 거부 규칙
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
```

### 13.3 인덱스 및 에뮬레이터 구동
- 인덱스 정의는 `firestore.indexes.json`에 포함. 배포 명령: `firebase deploy --only firestore:indexes`
- 에뮬레이터 포트: UI 4000, Auth 9099, Firestore 8080, Storage 9199, Functions 5001

``` 
{
  "firestore": {
    "rules": "firestore.rules",
    "indexes": "firestore.indexes.json"
  },
  "functions": {
    "predeploy": [
      "npm --prefix \"$RESOURCE_DIR\" run build"
    ],
    "source": "functions",
    "runtime": "nodejs20"
  },
  "storage": {
    "rules": "storage.rules"
  },
  "hosting": {
    "headers": [
      {
        "source": "**",
        "headers": [
          { "key": "Access-Control-Allow-Origin", "value": "*" },
          { "key": "Access-Control-Allow-Methods", "value": "GET, POST, PUT, DELETE, OPTIONS" },
          { "key": "Access-Control-Allow-Headers", "value": "Content-Type, Authorization" }
        ]
      }
    ]
  },
  "emulators": {
    "auth": { "port": 9099 },
    "functions": { "port": 5001 },
    "firestore": { "port": 8080 },
    "storage": { "port": 9199 },
    "ui": { "enabled": true, "port": 4000 },
    "singleProjectMode": true
  }
}
```

---

## 14. Firebase Storage 설계 및 보안 규칙

### 14.1 경로 표준
- 사용자 아바타: `users/{userId}/profile/{fileName}`
- 태스크 파일: `tasks/{taskId}/files/{fileName}`
- 태스크 댓글 파일: `tasks/{taskId}/comments/{commentId}/files/{fileName}`
- 채팅 첨부파일: `groups/{groupId}/chat/{userId}/{fileName}`
- 임시 업로드: `temp/{userId}/{fileName}`
- 시스템 파일: `system/{fileName}` (읽기 전용)

### 14.2 Storage 보안 규칙 (실제 적용본)

``` 
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    
    // Helper functions for storage security
    function isAuthenticated() {
      return request.auth != null;
    }
    
    function isOwner(userId) {
      return isAuthenticated() && request.auth.uid == userId;
    }
    
    function isValidImageType() {
      return request.resource.contentType.matches('image/.*');
    }
    
    function isValidFileSize(maxSizeInMB) {
      return request.resource size < maxSizeInMB * 1024 * 1024;
    }
    
    function isValidFileName() {
      return request.resource.name.size() < 100; // File name length limit
    }
    
    function isValidFileType() {
      return request.resource.contentType.matches('image/.*|application/pdf|text/.*|application/msword|application/vnd.openxmlformats-officedocument.*|application/vnd.ms-excel|application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
    }
    
    // User profile images
    match /users/{userId}/profile/{fileName} {
      allow read: if true; // Profile images are public
      allow write: if isOwner(userId) && 
        isValidImageType() && 
        isValidFileName() &&
        request.resource.size > 0; // 파일 크기가 0보다 크기만 확인
      allow delete: if isOwner(userId);
    }
    
    // Task files - accessible by task members
    match /tasks/{taskId}/files/{fileName} {
      allow read: if isAuthenticated(); // Authenticated users can read
      allow write: if isAuthenticated() && 
        isValidFileSize(10) && // 10MB limit for task files
        isValidFileName() &&
        isValidFileType();
      allow delete: if isAuthenticated(); // Task owner or group admin should handle via app logic
    }
    
    // Task comment files - accessible by task members
    match /tasks/{taskId}/comments/{commentId}/files/{fileName} {
      allow read: if isAuthenticated(); // Authenticated users can read
      allow write: if isAuthenticated() && 
        isValidFileSize(10) && // 10MB limit for comment files
        isValidFileName() &&
        isValidFileType();
      allow delete: if isAuthenticated(); // Comment owner should handle via app logic
    }
    
    // Task attachments - accessible by task members
    match /tasks/{taskId}/attachments/{fileName} {
      allow read: if isAuthenticated(); // Authenticated users can read
      allow write: if isAuthenticated() && 
        isValidFileSize(10) && // 10MB limit for task attachments
        isValidFileName() &&
        request.resource.contentType.matches('image/.*|application/pdf|text/.*|application/msword|application/vnd.openxmlformats-officedocument.*');
      allow delete: if isAuthenticated(); // Task owner or group admin should handle via app logic
    }
    
    // Task attachments (new path) - accessible by task members
    match /task-attachments/{fileName} {
      allow read: if isAuthenticated(); // Authenticated users can read
      allow write: if isAuthenticated() && 
        isValidFileSize(10) && // 10MB limit for task attachments
        isValidFileName() &&
        request.resource.contentType.matches('image/.*|application/pdf|text/.*|application/msword|application/vnd.openxmlformats-officedocument.*|application/vnd.ms-excel|application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
      allow delete: if isAuthenticated(); // Task owner or group admin should handle via app logic
    }
    
    // Group shared files
    match /groups/{groupId}/files/{fileName} {
      allow read: if isAuthenticated(); // Group members only (verified via app)
      allow write: if isAuthenticated() && 
        isValidFileSize(100) && // 100MB limit for group files
        isValidFileName();
      allow delete: if isAuthenticated(); // Group admin should handle via app logic
    }
    
    // Group chat attachments
    match /groups/{groupId}/chat/{userId}/{fileName} {
      allow read: if isAuthenticated(); // Group members can read chat attachments
      allow write: if isAuthenticated() && 
        isValidFileSize(100) && // 100MB limit for chat attachments
        isValidFileName() &&
        isValidFileType();
      allow delete: if isAuthenticated(); // Chat message owner should handle via app logic
    }
    
    // Temporary uploads (for processing)
    match /temp/{userId}/{fileName} {
      allow read, write: if isOwner(userId) && 
        isValidFileSize(50) && // 50MB limit for temporary files
        isValidFileName();
      allow delete: if isOwner(userId);
    }
    
    // System files (app icons, etc.) - read only
    match /system/{fileName} {
      allow read: if true;
      allow write: if false; // Only admin can upload system files
    }
    
    // Backup files (admin only)
    match /backups/{fileName} {
      allow read, write: if false; // Only server can access backups
    }
    
    // Default deny all other paths
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
```

### 14.3 CORS 설정
- Firebase Hosting 헤더에 기본 CORS 허용이 포함되어 있습니다. 필요 시 `npm run firebase:setup-cors` 사용

---

## 15. Vercel 배포 및 환경 변수

### 15.1 프로젝트 설정
- 빌드 명령: `npm run build:vercel` (Vite 빌드)
- 출력 디렉토리: `dist`
- SPA 라우팅: 모든 경로 `index.html`로 rewrite

### 15.2 vercel.json (실제 적용본)

``` 
{
  "version": 2,
  "name": "moonwave-plan",
  "builds": [
    { "src": "package.json", "use": "@vercel/static-build", "config": { "distDir": "dist" } }
  ],
  "buildCommand": "npm run build:vercel",
  "routes": [
    { "handle": "filesystem" },
    { "src": "/(.*)", "dest": "/index.html" }
  ],
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        { "key": "X-Content-Type-Options", "value": "nosniff" },
        { "key": "X-Frame-Options", "value": "DENY" },
        { "key": "X-XSS-Protection", "value": "1; mode=block" },
        { "key": "Referrer-Policy", "value": "strict-origin-when-cross-origin" }
      ]
    },
    {
      "source": "/assets/(.*)",
      "headers": [ { "key": "Cache-Control", "value": "public, max-age=31536000, immutable" } ]
    },
    {
      "source": "/firebase-messaging-sw.js",
      "headers": [
        { "key": "Content-Type", "value": "application/javascript" },
        { "key": "Service-Worker-Allowed", "value": "/" },
        { "key": "Cache-Control", "value": "no-cache, no-store, must-revalidate" }
      ]
    },
    {
      "source": "/manifest.json",
      "headers": [
        { "key": "Content-Type", "value": "application/manifest+json" },
        { "key": "Cache-Control", "value": "public, max-age=3600" }
      ]
    }
  ],
  "env": {
    "VITE_APP_NAME": "@VITE_APP_NAME",
    "VITE_APP_VERSION": "@VITE_APP_VERSION",
    "VITE_APP_URL": "@VITE_APP_URL",
    "VITE_FIREBASE_API_KEY": "@VITE_FIREBASE_API_KEY",
    "VITE_FIREBASE_AUTH_DOMAIN": "@VITE_FIREBASE_AUTH_DOMAIN",
    "VITE_FIREBASE_PROJECT_ID": "@VITE_FIREBASE_PROJECT_ID",
    "VITE_FIREBASE_STORAGE_BUCKET": "@VITE_FIREBASE_STORAGE_BUCKET",
    "VITE_FIREBASE_MESSAGING_SENDER_ID": "@VITE_FIREBASE_MESSAGING_SENDER_ID",
    "VITE_FIREBASE_APP_ID": "@VITE_FIREBASE_APP_ID",
    "VITE_FIREBASE_MEASUREMENT_ID": "@VITE_FIREBASE_MEASUREMENT_ID",
    "VITE_FCM_VAPID_KEY": "@VITE_FCM_VAPID_KEY",
    "VITE_ENABLE_PWA": "@VITE_ENABLE_PWA",
    "VITE_ENABLE_NOTIFICATIONS": "@VITE_ENABLE_NOTIFICATIONS",
    "VITE_ENABLE_CLAUDE_AI": "@VITE_ENABLE_CLAUDE_AI",
    "VITE_CLAUDE_API_KEY": "@VITE_CLAUDE_API_KEY",
    "CLAUDE_API_KEY": "@CLAUDE_API_KEY",
    "VITE_CLAUDE_MODEL": "@VITE_CLAUDE_MODEL",
    "VITE_CLAUDE_MAX_TOKENS": "@VITE_CLAUDE_MAX_TOKENS",
    "VITE_CLAUDE_TASK_ASSISTANT": "@VITE_CLAUDE_TASK_ASSISTANT",
    "VITE_CLAUDE_SMART_SUGGESTIONS": "@VITE_CLAUDE_SMART_SUGGESTIONS",
    "VITE_NODE_ENV": "@VITE_NODE_ENV",
    "VITE_DEBUG": "@VITE_DEBUG",
    "VITE_API_BASE_URL": "@VITE_API_BASE_URL",
    "VITE_ENABLE_ANALYTICS": "@VITE_ENABLE_ANALYTICS",
    "VITE_GOOGLE_ANALYTICS_ID": "@VITE_GOOGLE_ANALYTICS_ID",
    "VITE_SENTRY_DSN": "@VITE_SENTRY_DSN"
  },
  "functions": {
    "src/pages/api/**/*.ts": { "runtime": "nodejs20.x" }
  }
}
```

### 15.3 환경변수 일람 및 의미
- VITE_APP_NAME, VITE_APP_VERSION, VITE_APP_URL: 앱 메타 정보
- VITE_FIREBASE_*: Firebase 웹 앱 구성
- VITE_FCM_VAPID_KEY: 웹 푸시 키
- VITE_ENABLE_PWA, VITE_ENABLE_NOTIFICATIONS, VITE_ENABLE_ANALYTICS: 기능 플래그
- VITE_CLAUDE_*, CLAUDE_API_KEY: Claude AI 통합 설정(선택)
- VITE_API_BASE_URL: 외부 API 연동 시 사용
- VITE_SENTRY_DSN, VITE_GOOGLE_ANALYTICS_ID: 모니터링/분석

### 15.4 배포 절차 (Vercel 대시보드)
1. 프로젝트 연결 (GitHub repository)
2. Environment Variables에 위 변수 추가
3. 빌드 명령 `npm run build:vercel`, Output `dist` 확인
4. 배포 후 SPA 라우팅 동작 확인

### 15.5 CLI/CI 배포 (GitHub Actions)
- Settings > Secrets and variables > Actions: `VERCEL_TOKEN`, `VERCEL_ORG_ID`, `VERCEL_PROJECT_ID`
- PR 시 Preview 배포, main/master 머지 시 Production 배포

---

## 16. 도메인 유지 가이드 (커스텀 도메인)

### 16.1 연결 방식
- Vercel의 Domains 메뉴에서 커스텀 도메인 추가
- DNS가 외부 레지스트라에 있을 경우, 안내되는 A/CNAME 레코드로 설정
- SSL/TLS는 Vercel에서 자동 관리 (Let’s Encrypt)

### 16.2 점검 체크리스트
- 인증서 유효성 확인 (HTTPS 강제 적용)
- `www` 서브도메인 리다이렉트 필요 여부 검토
- 캐시 무효화: 변경 후 새 배포 링크 확인

---

## 17. CI/CD 파이프라인 (GitHub Actions)

### 17.1 워크플로 개요: `.github/workflows/ci.yml`
- 단계: test → build → (e2e 선택) → security → deploy-preview (PR) / deploy-production (main/master)
- Node 20, `npm ci` 사용, 품질 검사(quality:check), 타입 체크, 빌드 수행
- Vercel Action으로 Preview/Production 배포, `--yes --confirm`로 비대화형 설정

```yaml
name: CI/CD Pipeline

on:
  push:
    branches: [ main, master, develop ]
  pull_request:
    branches: [ main, master ]

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  test:
    name: Test Suite
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      - run: npm ci
      - run: npm run quality:check
      - run: npm run test:ci
      - uses: codecov/codecov-action@v3
        with:
          file: ./coverage/lcov.info
          fail_ci_if_error: false

  build:
    name: Build Application
    runs-on: ubuntu-latest
    needs: test
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      - run: npm ci
      - name: Build application
        run: npm run build:production
        env:
          CI: true
          NODE_ENV: production

  e2e:
    name: E2E Tests
    runs-on: ubuntu-latest
    needs: build
    if: false
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      - run: npm ci
      - run: npx playwright install --with-deps
      - run: npm run test:e2e
      - uses: actions/upload-artifact@v4
        if: failure()
        with:
          name: playwright-report
          path: playwright-report/
          retention-days: 7

  security:
    name: Security Scan
    runs-on: ubuntu-latest
    needs: test
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      - run: npm ci
      - name: Run security audit
        run: npm audit --audit-level=high
        continue-on-error: true
      - name: Run custom security checks
        run: npm run security:check
        continue-on-error: true

  deploy-preview:
    name: Deploy Preview
    runs-on: ubuntu-latest
    needs: [test]
    if: github.event_name == 'pull_request'
    steps:
      - uses: actions/checkout@v4
      - uses: vercel/action@v1
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          working-directory: ./
          vercel-args: '--yes --confirm'

  deploy-production:
    name: Deploy to Production
    runs-on: ubuntu-latest
    needs: [test, security]
    if: github.ref == 'refs/heads/main' || github.ref == 'refs/heads/master'
    steps:
      - uses: actions/checkout@v4
      - uses: vercel/action@v1
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          working-directory: ./
          vercel-args: '--prod --yes --confirm'
```

### 17.2 필요 시크릿
- `VERCEL_TOKEN`, `VERCEL_ORG_ID`, `VERCEL_PROJECT_ID`

---

## 18. 로컬 개발 환경

### 18.1 기본 명령 (package.json)
- 개발 서버: `npm run dev`
- 깨끗한 개발 시작: `npm run dev:fresh`
- 프로덕션 빌드: `npm run build:production`
- 정적 프리뷰: `npm run preview`

### 18.2 Firebase 에뮬레이터
- 에뮬레이터 실행 시 포트 충돌 방지: `npm run dev:clean`
- Firestore/Rules/Indexes/Storage와 Functions를 함께 테스트

### 18.3 기타 유틸리티 스크립트
- 보안 점검: `npm run security:check`
- PWA 점검: `npm run pwa:check`
- Functions 배포 유틸: `npm run functions:deploy`

---

## 19. 프론트엔드 라우팅 및 상태

### 19.1 라우팅 (React Router)
- 보호 라우트: `/`, `/todo`, `/tasks/*`, `/family`, `/points`, `/statistics`, `/settings`, `/notifications`
- 공개 라우트: `/login`, `/about`, `/terms-of-service`, `/project-detail/:projectId`
- SPA 라우팅은 Vercel에서 모든 경로를 `index.html`로 rewrite

### 19.2 Firebase 클라이언트 초기화
- 설정 파일 예시: `src/lib/firebase.ts`
- 환경변수 미설정 시 안전한 기본값으로 폴백 (개발 편의)

```ts
const config = {
  apiKey: import.meta.env.VITE_FIREBASE_API_KEY,
  authDomain: import.meta.env.VITE_FIREBASE_AUTH_DOMAIN,
  projectId: import.meta.env.VITE_FIREBASE_PROJECT_ID,
  storageBucket: import.meta.env.VITE_FIREBASE_STORAGE_BUCKET,
  messagingSenderId: import.meta.env.VITE_FIREBASE_MESSAGING_SENDER_ID,
  appId: import.meta.env.VITE_FIREBASE_APP_ID,
  measurementId: import.meta.env.VITE_FIREBASE_MEASUREMENT_ID
};
```

### 19.3 스토리지 사용 규칙
- 아바타 업로드는 본인만 가능, 공개 읽기
- 채팅/태스크 첨부는 인증 사용자만 업로드 가능(용량/확장자 제한 적용)

---

## 20. 배포 체크리스트 (요약)

1. Firebase 프로젝트/환경변수 준비 (웹 앱 구성, FCM VAPID)
2. Firestore 규칙/인덱스/Storage 규칙 반영: `npm run firebase:deploy`
3. Vercel 환경변수 설정 및 빌드/배포
4. 도메인 연결 및 HTTPS 확인 (커스텀 도메인)
5. 기능 플래그 및 분석/모니터링 설정값 확인
6. 알림(FCM), PWA, 라우팅 동작 점검

---

본 문서는 저장소 간 100% 동일성을 목표로 하며, 수정 시 버전과 변경 이력을 명시하고 동일한 구조/값을 유지하세요.
